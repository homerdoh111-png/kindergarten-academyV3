<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kindergarten Academy - Learn & Play!</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#4A90E2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="favicon.ico">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Comic+Neue:wght@700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles-v3.css">
</head>
<body>
    <!-- Beautiful Treehouse Background Image -->
    <div class="treehouse-background"></div>
    
    <!-- 3D Overlay Canvas for Animated Elements -->
    <canvas id="treehouseCanvas"></canvas>
    
    <!-- Authentication Modal (appears first) -->
    <div class="auth-modal" id="authModal">
        <div class="auth-modal-content">
            <h2 class="auth-title">Welcome to Kindergarten Academy! ğŸ»</h2>
            
            <!-- Login Form -->
            <div class="auth-form" id="loginForm">
                <h3>Sign In</h3>
                <input type="email" id="loginEmail" placeholder="Email" class="auth-input">
                <input type="password" id="loginPassword" placeholder="Password" class="auth-input">
                <button class="auth-btn" id="loginBtn">Sign In</button>
                <p class="auth-switch">Don't have an account? <span id="showSignup">Sign Up</span></p>
            </div>
            
            <!-- Signup Form -->
            <div class="auth-form hidden" id="signupForm">
                <h3>Create Account</h3>
                <input type="text" id="signupName" placeholder="Child's Name" class="auth-input">
                <input type="number" id="signupAge" placeholder="Age" class="auth-input" min="4" max="7">
                <input type="email" id="signupEmail" placeholder="Parent's Email" class="auth-input">
                <input type="password" id="signupPassword" placeholder="Password" class="auth-input">
                <button class="auth-btn" id="signupBtn">Create Account</button>
                <p class="auth-switch">Already have an account? <span id="showLogin">Sign In</span></p>
            </div>
            
            <div class="auth-error" id="authError"></div>
        </div>
    </div>
    
    <!-- Main App Container -->
    <div id="app">
        
        <!-- Login Screen (after auth) -->
        <div class="screen active" id="loginScreen">
            <div class="login-container">
                <h1>ğŸ« Kindergarten Academy</h1>
                <p>Learn letters, numbers, and more!</p>
                <input type="text" id="usernameInput" placeholder="Enter your name" maxlength="20">
                <button id="startBtn" class="primary-btn">Start Learning! ğŸš€</button>
            </div>
        </div>

        <!-- Main Treehouse Screen -->
        <div class="screen" id="treehouseScreen">
            <!-- Top Bar -->
            <div class="top-bar">
                <div class="child-name" id="displayName">ğŸ‘‹ Hello!</div>
                <div class="star-count" id="starCount">â­ 0</div>
            </div>

            <!-- Buddy Bear Container -->
            <div id="buddyContainer">
                <div id="buddy-3d"></div>
                <div class="speech-bubble" id="speechBubble">
                    Hi! I'm Buddy! Let's learn together! ğŸˆ
                </div>
            </div>

            <!-- Activity Buttons (Floating around treehouse) -->
            <div class="activity-grid">
                <button class="activity-btn" data-activity="letters">
                    <span class="activity-icon">ğŸ“š</span>
                    <span class="activity-label">Letters</span>
                </button>
                
                <button class="activity-btn" data-activity="numbers">
                    <span class="activity-icon">ğŸ”¢</span>
                    <span class="activity-label">Numbers</span>
                </button>
                
                <button class="activity-btn" data-activity="colors">
                    <span class="activity-icon">ğŸ¨</span>
                    <span class="activity-label">Colors</span>
                </button>
                
                <button class="activity-btn" data-activity="shapes">
                    <span class="activity-icon">â¬›</span>
                    <span class="activity-label">Shapes</span>
                </button>
                
                <button class="activity-btn" data-activity="math">
                    <span class="activity-icon">â•</span>
                    <span class="activity-label">Math</span>
                </button>
                
                <button class="activity-btn" data-activity="time">
                    <span class="activity-icon">ğŸ•</span>
                    <span class="activity-label">Time</span>
                </button>
                
                <button class="activity-btn" data-activity="money">
                    <span class="activity-icon">ğŸ’°</span>
                    <span class="activity-label">Money</span>
                </button>
                
                <button class="activity-btn" data-activity="logic">
                    <span class="activity-icon">ğŸ§©</span>
                    <span class="activity-label">Logic</span>
                </button>
                
                <button class="activity-btn" data-activity="rhymes">
                    <span class="activity-icon">ğŸµ</span>
                    <span class="activity-label">Rhymes</span>
                </button>
                
                <button class="activity-btn" data-activity="phonics">
                    <span class="activity-icon">ğŸ—£ï¸</span>
                    <span class="activity-label">Phonics</span>
                </button>
            </div>

            <!-- Bottom Actions -->
            <div class="bottom-bar">
                <button class="icon-btn" id="voiceBtn" title="Talk to Buddy">ğŸ¤</button>
                <button class="icon-btn" id="jokeBtn" title="Tell a joke">ğŸ˜„</button>
            </div>

            <!-- Star Counter -->
            <div class="star-counter">
                <span class="star-icon">â­</span>
                <span id="starCount">0</span>
            </div>
        </div>

        <!-- Activity Screens (Will be added dynamically) -->
        <div class="screen" id="activityScreen">
            <div class="activity-header">
                <button class="back-btn" id="backBtn">â† Back</button>
                <h2 id="activityTitle">Activity</h2>
            </div>
            <div class="activity-content" id="activityContent">
                <!-- Content loaded dynamically -->
            </div>
        </div>

        <!-- Tasks Screen -->
        <div class="screen" id="tasksScreen">
            <div class="activity-header">
                <button class="back-btn" id="backFromTasks">â† Back</button>
                <h2>ğŸ“‹ My Tasks</h2>
            </div>
            <div class="tasks-content">
                <div id="tasksList">
                    <!-- Tasks loaded dynamically -->
                </div>
            </div>
        </div>

    </div>

    <!-- Three.js for 3D Environment -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    
    <!-- Supabase for Authentication & Data -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- App Scripts -->
    <script src="treehouse-overlay.js"></script>
    <script src="buddy-v3.js"></script>
    <script src="voice-v3.js"></script>
    <script src="activities-v3.js"></script>
    <script src="app-v3.js"></script>
</body>
</html>
